"0","cyt_infra_fin_outliers <- cyt_infra_fin |> dplyr::select(CYT_18,CYT_20,FIN_40,FIN_41,FIN_42,FIN_43,FIN_44,FIN_46,INFRA_26,INFRA_27,INFRA_28,INFRA_33,INFRA_37,INFRA_38)"
"0",""
"0","box_cox <- function(tipo){"
"0","  datos <- cyt_infra_fin |> dplyr::select(colnames(cyt_infra_fin_outliers)) |> dplyr::select(-FIN_46) |>  dplyr::select(starts_with(tipo))"
"0","  for (i in 1:dim(datos)[2]){"
"0","    datos2 = datos[,i]"
"0","    nombre_variable <- colnames(datos2)"
"0","    colnames(datos2) <-  ""y"""
"0","    box_cox_trans <- MASS::boxcox(y ~ 1, data = datos2, lambda = seq(-2, 2, by = 0.1), plotit = F)"
"0","    lambda_vals <- box_cox_trans$x"
"0","    log_likelihood_vals <- box_cox_trans$y"
"0","    lambda_optimo <- lambda_vals[which.max(log_likelihood_vals)]"
"0","    plot(density(datos2$y), main = ""Datos originales"","
"0","           xlab = nombre_variable, cex.main = 2, col = ""red"")"
"0","    plot(lambda_vals, log_likelihood_vals, type = ""l"","
"0","           xlab = ""Lambda"", ylab = ""Log-Likelihood"","
"0","           main = TeX(paste(""Box-Cox"", ""\\lambda"", ""="",round(lambda_optimo,2))), cex.main = 2, col = ""green"")"
"0","    abline(v = lambda_optimo, col = ""red"", lty = 2)"
"0","    plot(density((datos2$y^lambda_optimo-1)/lambda_optimo),"
"0","         main = ""Transformación de Box-Cox"","
"0","         xlab = paste(nombre_variable, ""después de la T. de Box-Cox""), cex.main = 2,"
"0","         col = ""blue"")"
"0","  }"
"0","}"
